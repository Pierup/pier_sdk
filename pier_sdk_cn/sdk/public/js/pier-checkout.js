/**@author Flower Cheng*@Date 2015-09-21*@description 品而支付API**/
(function(h){h=this;PIER=h.PIER={version:"1.0.0"};PIER.initSDK=function(w,x){var a=w||{},d=[],n=a.amount||"",p=a.merchant_id||"",q=a.currency||"",k=a.order_id||"",r=a.api_id||"",e=a.order_detail||{},l=a.return_url||"",t=a.sign||"",u=a.sign_type||"",v=a.charset||"",y=a.callback_default||!1,a=a.pay_button_id||"";(function(a){if("object"!=typeof a)throw Error("\u53c2\u6570\u9519\u8bef\uff01");for(var b in a)if(""==a[b]||void 0==a[b]||null==a[b])throw Error("\u53c2\u6570\u9519\u8bef\uff01 "+b+"\u4e0d\u80fd\u4e3a\u7a7a");
})({amount:n,merchant_id:p,currency:q,api_key:r,return_url:l,sign:t,sign_type:u,charset:v,pay_button_id:a});var b="product logo detail type price count total".split(" ");if(""==k||void 0==k||null==k)for(_detail in e){var g=e[_detail];d[_detail]={};for(var c=0;c<b.length;c++)if(g.hasOwnProperty(b[c]))d[_detail][b[c]]=e[_detail][b[c]];else throw Error("\u5bf9\u4e0d\u8d77\uff0c\u60a8\u4f20\u7684\u7b2c"+(parseFloat(_detail)+1)+"\u4e2a\u5546\u54c1\u7684\u5c5e\u6027\uff1a"+b[c]+"\u4e0d\u80fd\u4e3a\u7a7a");
}else for(_detail in e)for(g=e[_detail],d[_detail]={},c=0;c<b.length;c++)g.hasOwnProperty(b[c])?d[_detail][b[c]]=e[_detail][b[c]]:d[_detail][b[c]]="";""!=e&&(e=JSON.stringify(d));d=document.querySelector('[id="'+a+'"]');a=document.createElement("style");document.head.appendChild(a);var f=a.sheet;f.addRule||(f.addRule=function(a,b){f.insertRule(a+"{"+b+"}",f.cssRules.length)});f.addRule(".pier-overlay","position:fixed;left:0;top:0;width:100%;height:100%;z-index:100;background:rgba(0,0,0,0.3);visibility:visible;opacity:1;font-size:10px;");
f.addRule(".pier-checkout-check","margin:0 auto; width:380px;height:220px;background: transparent; border:1px solid #ccc;margin-top: 80px;border-top: 0px;");f.addRule(".pier-checkout-check button","width: 120px;height: 38px; text-align: center;border:1px solid #ccc;margin-top:100px;cursor:pointer;");f.addRule(".pier-checkout-check button:hover","background: #fff;");f.addRule(".mL-20","margin-left:20px;");var m=document.createElement("div"),a=document.createElement("div");a.classList.add("pier-checkout-check");
b=document.createElement("button");g=document.createElement("button");g.classList.add("mL-20");b.innerHTML="\u652f\u4ed8\u6210\u529f";g.innerHTML="\u652f\u4ed8\u9047\u5230\u95ee\u9898";a.appendChild(b);a.appendChild(g);m.classList.add("pier-overlay");var z=d.parentElement;m.appendChild(a);b.onclick=function(){h.location.href=l};g.onclick=function(){h.location.href=l};d.onclick=function(){var a=document.createElement("form");a.action="http://pierup.cn:4000/checkout/login";a.target="_blank";a.method=
"post";a.style.display="none";var b={amount:n,currency:q,order_id:k,api_id:r,merchant_id:p,order_detail:e,return_url:l,sign:t,sign_type:u,charset:v},c;for(c in b){var d=document.createElement("textarea");d.name=c;d.value=b[c];a.appendChild(d)}document.body.appendChild(a);a.submit();y?z.appendChild(m):x.call(this)}}})(window);